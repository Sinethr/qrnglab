class QuantumNumberPickerTool{constructor(e){this.container=document.getElementById(e),this.results=[],this.init()}init(){this.container.innerHTML='\n      <div class="tool-card">\n        <div class="tool-header">\n          <h2>ğŸŸï¸ Quantum Number Picker</h2>\n          <p class="tool-description">Pick unique random numbers from any range - perfect for lottery draws, ticket selection, and fair number assignment</p>\n        </div>\n        \n        <div class="tool-controls">\n          <div class="control-row space-y-4">\n            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">\n              <div class="input-group">\n                <label for="pick-min" class="block text-sm font-bold text-gray-700 mb-1">Minimum Number</label>\n                <input type="number" id="pick-min" value="1" min="0" max="999999" \n                  class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-quantum-light focus:border-quantum-light outline-none transition-all shadow-sm text-gray-800 font-mono">\n              </div>\n              \n              <div class="input-group">\n                <label for="pick-max" class="block text-sm font-bold text-gray-700 mb-1">Maximum Number</label>\n                <input type="number" id="pick-max" value="49" min="1" max="999999"\n                  class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-quantum-light focus:border-quantum-light outline-none transition-all shadow-sm text-gray-800 font-mono">\n              </div>\n              \n              <div class="input-group">\n                <label for="pick-count" class="block text-sm font-bold text-gray-700 mb-1">How Many to Pick</label>\n                <input type="number" id="pick-count" value="6" min="1" max="100"\n                  class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-quantum-light focus:border-quantum-light outline-none transition-all shadow-sm text-gray-800 font-mono">\n                <span class="text-xs text-gray-500 mt-1 block" id="pick-hint">Max: 49 numbers</span>\n              </div>\n            </div>\n          </div>\n          \n          <div class="control-row mt-6 mb-6">\n            <div class="preset-buttons flex flex-wrap gap-2">\n              <button class="preset-btn px-3 py-1 bg-gray-100 hover:bg-gray-200 text-sm font-medium rounded-md transition-colors border border-gray-300" data-preset="lottery649">Lottery 6/49</button>\n              <button class="preset-btn px-3 py-1 bg-gray-100 hover:bg-gray-200 text-sm font-medium rounded-md transition-colors border border-gray-300" data-preset="powerball">Powerball 5/69</button>\n              <button class="preset-btn px-3 py-1 bg-gray-100 hover:bg-gray-200 text-sm font-medium rounded-md transition-colors border border-gray-300" data-preset="mega">Mega 5/70</button>\n              <button class="preset-btn px-3 py-1 bg-gray-100 hover:bg-gray-200 text-sm font-medium rounded-md transition-colors border border-gray-300" data-preset="euro">Euro 5/50</button>\n            </div>\n          </div>\n          \n          <div class="control-row flex gap-6 items-center mb-6">\n            <div class="checkbox-group flex items-center gap-2">\n              <input type="checkbox" id="sort-results" checked class="w-5 h-5 text-quantum-light rounded border-gray-300 focus:ring-quantum-light" />\n              <label for="sort-results" class="font-medium text-gray-700 cursor-pointer">Sort results</label>\n            </div>\n            \n            <div class="checkbox-group flex items-center gap-2">\n              <input type="checkbox" id="show-positions" class="w-5 h-5 text-quantum-light rounded border-gray-300 focus:ring-quantum-light" />\n              <label for="show-positions" class="font-medium text-gray-700 cursor-pointer">Show draw positions</label>\n            </div>\n          </div>\n          \n          <button id="pick-numbers" class="generate-btn">\n            <span class="btn-icon">ğŸ¯</span>\n            Pick Numbers\n          </button>\n        </div>\n        \n        <div class="tool-results">\n          <div id="pick-loading" class="loading hidden">\n            <div class="spinner"></div>\n            <p>Quantum number selection...</p>\n          </div>\n          \n          <div id="pick-error" class="error hidden">\n            <div class="error-icon">âš ï¸</div>\n            <div class="error-content">\n              <h4>Error</h4>\n              <p id="pick-error-message"></p>\n            </div>\n          </div>\n          \n          <div id="pick-success" class="success hidden">\n            <div class="result-header">\n              <h3>ğŸ¯ Selected Numbers</h3>\n              <div class="result-actions">\n                <button id="copy-pick-results" class="copy-btn">ğŸ“‹ Copy Numbers</button>\n                <button id="download-pick-results" class="download-btn">ğŸ’¾ Download</button>\n                <button id="pick-again" class="secondary-btn">ğŸ”„ Pick Again</button>\n              </div>\n            </div>\n            \n            <div class="result-metadata">\n              <span class="metadata-item">Range: <strong id="pick-range-display"></strong></span>\n              <span class="metadata-item">Selected: <strong id="pick-count-display"></strong></span>\n              <span class="metadata-item">Method: <strong>Quantum Unique Selection</strong></span>\n              <span class="metadata-item">Time: <strong id="pick-timestamp"></strong></span>\n            </div>\n            \n            <div class="number-balls-display" id="number-balls">\n              \x3c!-- Number balls will be populated here --\x3e\n            </div>\n            \n            <div class="selection-details" id="selection-details">\n              \x3c!-- Selection order details when show-positions is checked --\x3e\n            </div>\n          </div>\n          \n          <div class="use-cases-section">\n            <h3>ğŸ¯ Common Use Cases</h3>\n            <div class="use-cases-grid">\n              <div class="use-case">\n                <h4>ğŸ° Lottery Numbers</h4>\n                <p>Generate fair lottery number combinations for any lottery system</p>\n              </div>\n              <div class="use-case">\n                <h4>ğŸŸï¸ Ticket Draws</h4>\n                <p>Select winning ticket numbers for raffles and prize drawings</p>\n              </div>\n              <div class="use-case">\n                <h4>ğŸ“‹ ID Assignment</h4>\n                <p>Assign unique ID numbers for participants, teams, or items</p>\n              </div>\n              <div class="use-case">\n                <h4>ğŸ² Game Numbers</h4>\n                <p>Generate number sets for bingo, keno, or custom games</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ',this.bindEvents(),this.updateMaxHint()}bindEvents(){const e=this.container.querySelector("#pick-numbers"),t=this.container.querySelector("#pick-again"),n=this.container.querySelector("#copy-pick-results"),s=this.container.querySelector("#download-pick-results"),r=this.container.querySelector("#pick-min"),i=this.container.querySelector("#pick-max"),o=this.container.querySelector("#pick-count");e.addEventListener("click",()=>this.pickNumbers()),t.addEventListener("click",()=>this.pickNumbers()),n.addEventListener("click",()=>this.copyResults()),s.addEventListener("click",()=>this.downloadResults()),this.container.querySelectorAll(".preset-btn").forEach(e=>{e.addEventListener("click",e=>this.applyPreset(e.target.dataset.preset))}),[r,i,o].forEach(e=>{e.addEventListener("input",()=>this.updateMaxHint())}),r.addEventListener("change",()=>{const e=parseInt(r.value);e>parseInt(i.value)&&(i.value=e),this.updateMaxHint()}),i.addEventListener("change",()=>{const e=parseInt(r.value),t=parseInt(i.value);t<e&&(r.value=t),this.updateMaxHint()}),[r,i,o].forEach(e=>{e.addEventListener("keypress",e=>{"Enter"===e.key&&this.pickNumbers()})})}updateMaxHint(){const e=parseInt(this.container.querySelector("#pick-min").value)||0,t=parseInt(this.container.querySelector("#pick-max").value)||0,n=Math.max(0,t-e+1);this.container.querySelector("#pick-hint").textContent=`Max: ${Math.min(n,100)} numbers`;this.container.querySelector("#pick-count").max=Math.min(n,100)}applyPreset(e){const t={lottery649:{min:1,max:49,count:6},powerball:{min:1,max:69,count:5},mega:{min:1,max:70,count:5},euro:{min:1,max:50,count:5}}[e];t&&(this.container.querySelector("#pick-min").value=t.min,this.container.querySelector("#pick-max").value=t.max,this.container.querySelector("#pick-count").value=t.count,this.updateMaxHint())}async pickNumbers(){const e=parseInt(this.container.querySelector("#pick-min").value),t=parseInt(this.container.querySelector("#pick-max").value),n=parseInt(this.container.querySelector("#pick-count").value),s=this.container.querySelector("#sort-results").checked,r=this.container.querySelector("#show-positions").checked;if(isNaN(e)||isNaN(t)||isNaN(n))return void this.showError("Please enter valid numbers for all fields");if(e>t)return void this.showError("Minimum cannot be greater than maximum");const i=t-e+1;if(n>i)this.showError(`Cannot pick ${n} unique numbers from ${i} available numbers`);else if(n>100)this.showError("Cannot pick more than 100 numbers at once");else{this.showLoading();try{let o,a=[];if(n/i>.5)o=await this.selectByRemoval(e,t,n);else{const s=await this.selectByRejection(e,t,n);o=s.numbers,a=s.order}this.results={numbers:s?[...o].sort((e,t)=>e-t):o,originalOrder:a,sorted:s,showPositions:r,range:[e,t],count:n},this.showResults(),qrngService.emit("tool_usage",{tool:"number_picker",range:[e,t],count:n,total_possible:i,selection_ratio:n/i})}catch(e){console.error("Number picking error:",e),this.showError(`Failed to pick numbers: ${e.message}`)}}}async selectByRejection(e,t,n){const s=new Set,r=[],i=t-e+1,o=Math.ceil(1.5*n);let a=await qrngService.getUint16(o),c=0;for(;s.size<n;){if(c>=a.length){const e=await qrngService.getUint16(Math.max(50,n));a=a.concat(e)}const t=e+a[c]%i;c++,s.has(t)||(s.add(t),r.push({number:t,position:s.size}))}return{numbers:Array.from(s),order:r}}async selectByRemoval(e,t,n){const s=Array.from({length:t-e+1},(t,n)=>e+n),r=await qrngService.getUint16(s.length);for(let e=s.length-1;e>0;e--){const t=r[s.length-1-e]%(e+1);[s[e],s[t]]=[s[t],s[e]]}return s.slice(0,n)}showResults(){this.container.querySelector("#pick-range-display").textContent=`[${this.results.range[0]}, ${this.results.range[1]}]`,this.container.querySelector("#pick-count-display").textContent=`${this.results.count} of ${this.results.range[1]-this.results.range[0]+1}`,this.container.querySelector("#pick-timestamp").textContent=(new Date).toLocaleTimeString();const e=this.container.querySelector("#number-balls");e.innerHTML="",this.results.numbers.forEach((t,n)=>{const s=document.createElement("div");s.className="number-ball",s.textContent=t,s.style.animationDelay=100*n+"ms",e.appendChild(s)});const t=this.container.querySelector("#selection-details");this.results.showPositions&&this.results.originalOrder.length>0?(t.innerHTML=`\n        <h4>Selection Order</h4>\n        <div class="selection-order">\n          ${this.results.originalOrder.map(e=>`<span class="order-item">Position ${e.position}: ${e.number}</span>`).join("")}\n        </div>\n      `,t.style.display="block"):t.style.display="none",this.container.querySelector("#pick-success").classList.remove("hidden"),this.container.querySelector("#pick-loading").classList.add("hidden"),this.container.querySelector("#pick-error").classList.add("hidden"),this.container.querySelector("#pick-numbers").disabled=!1}async copyResults(){const e=this.results.numbers.join(", ");try{await navigator.clipboard.writeText(e),this.showCopyFeedback(this.container.querySelector("#copy-pick-results"))}catch(e){console.error("Copy failed:",e)}}showCopyFeedback(e){const t=e.textContent;e.textContent="âœ… Copied",e.style.background="#10b981",setTimeout(()=>{e.textContent=t,e.style.background=""},1500)}downloadResults(){const e=(new Date).toISOString(),t=this.results.numbers.join(", ");let n=`Quantum Number Selection\nGenerated: ${e}\nRange: ${`${this.results.range[0]}-${this.results.range[1]}`}\nSelected: ${this.results.count} numbers\nMethod: Quantum Unique Selection\n\nSELECTED NUMBERS:\n${t}\n\nFORMATTED FOR LOTTERY:\n${this.results.numbers.join(" - ")}`;this.results.showPositions&&this.results.originalOrder.length>0&&(n+=`\n\nSELECTION ORDER:\n${this.results.originalOrder.map(e=>`${e.position}. ${e.number}`).join("\n")}`),n+=`\n\nSTATISTICS:\nTotal possible numbers: ${this.results.range[1]-this.results.range[0]+1}\nNumbers selected: ${this.results.count}\nSelection probability: 1 in ${Math.round((this.results.range[1]-this.results.range[0]+1)/this.results.count)}\n\n---\nGenerated using ANU Quantum Random Number Generator\nEach number had an equal chance of selection`;const s=new Blob([n],{type:"text/plain"}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download=`quantum-numbers-${Date.now()}.txt`,i.click(),URL.revokeObjectURL(r)}showLoading(){this.container.querySelector("#pick-loading").classList.remove("hidden"),this.container.querySelector("#pick-error").classList.add("hidden"),this.container.querySelector("#pick-success").classList.add("hidden"),this.container.querySelector("#pick-numbers").disabled=!0}showError(e){this.container.querySelector("#pick-error-message").textContent=e,this.container.querySelector("#pick-error").classList.remove("hidden"),this.container.querySelector("#pick-loading").classList.add("hidden"),this.container.querySelector("#pick-success").classList.add("hidden"),this.container.querySelector("#pick-numbers").disabled=!1}}window.QuantumNumberPickerTool=QuantumNumberPickerTool;