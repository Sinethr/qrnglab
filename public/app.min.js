class QuantumRandomApp{constructor(){this.tools={},this.currentSection="core",this.init()}async init(){this.initNavigation(),this.initializeTools(),this.initServiceMonitoring(),this.initAnalytics(),this.setupGlobalEventListeners()}initNavigation(){document.querySelectorAll(".nav-link").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.section;this.switchSection(t)})})}switchSection(e){document.querySelectorAll(".nav-link").forEach(t=>{t.classList.remove("active"),t.dataset.section===e&&t.classList.add("active")}),document.querySelectorAll(".tool-section").forEach(e=>{e.classList.remove("active")});const t=document.getElementById(`${e}-section`);t&&(t.classList.add("active"),this.currentSection=e),window.qrngService&&qrngService.emit("navigation",{section:e,timestamp:(new Date).toISOString()})}initializeTools(){try{const e=[{id:"quantum-integer-tool",class:QuantumIntegerTool,name:"integer"},{id:"quantum-number-picker-tool",class:QuantumNumberPickerTool,name:"numberPicker"},{id:"quantum-coin-flip-tool",class:QuantumCoinFlipTool,name:"coinFlip"},{id:"quantum-dice-tool",class:QuantumDiceTool,name:"dice"},{id:"quantum-name-tool",class:QuantumNameTool,name:"nameSelector"},{id:"quantum-color-tool",class:QuantumColorTool,name:"colorGenerator"},{id:"quantum-hex-tool",class:QuantumHexTool,name:"hexGenerator"},{id:"quantum-password-tool",class:QuantumPasswordTool,name:"passwordGenerator"}];let t=0;e.forEach(e=>{document.getElementById(e.id)&&(this.tools[e.name]=new e.class(e.id),t++)})}catch(e){console.error("‚ùå Failed to initialize tools:",e),this.showGlobalError("Failed to initialize quantum tools. Please refresh the page.")}}initServiceMonitoring(){const e=document.getElementById("status-indicator"),t=document.getElementById("status-text");if(!e||!t)return;const o=async()=>{try{const o=await qrngService.getHealth();"healthy"===o.status&&o.apiKeyConfigured?(e.className="status-indicator healthy",e.textContent="‚óè",t.textContent="Quantum service online"):"healthy"!==o.status||o.apiKeyConfigured?(e.className="status-indicator error",e.textContent="‚óè",t.textContent="Service unavailable"):(e.className="status-indicator error",e.textContent="‚óè",t.textContent="API key required")}catch(o){e.className="status-indicator error",e.textContent="‚óè",t.textContent="Connection failed"}};o(),setInterval(o,3e4)}initAnalytics(){window.qrngService&&(qrngService.addEventListener("tool_usage",e=>{this.logUsageStatistics(e)}),qrngService.addEventListener("request",()=>{this.incrementCounter("api_requests")}),qrngService.addEventListener("error",e=>{console.warn("üìä API Error:",e.error),this.incrementCounter("api_errors"),e.error&&(e.error.includes("Too many requests")||e.error.includes("try again after"))&&this.showGlobalError(`‚ö†Ô∏è <strong>API Rate Limit Exceeded:</strong> ${e.error}`)}),qrngService.addEventListener("cache_hit",()=>{this.incrementCounter("cache_hits")}),qrngService.addEventListener("cache_miss",()=>{this.incrementCounter("cache_misses")}))}logUsageStatistics(e){try{const t=JSON.parse(localStorage.getItem("quantumLabStats")||"{}"),o=e.tool;t[o]||(t[o]={count:0,lastUsed:null}),t[o].count++,t[o].lastUsed=e.timestamp,localStorage.setItem("quantumLabStats",JSON.stringify(t))}catch(e){console.warn("Failed to log usage statistics:",e)}}incrementCounter(e){try{const t=JSON.parse(localStorage.getItem("quantumLabCounters")||"{}");t[e]=(t[e]||0)+1,localStorage.setItem("quantumLabCounters",JSON.stringify(t))}catch(e){console.warn("Failed to increment counter:",e)}}setupGlobalEventListeners(){window.addEventListener("error",e=>{console.error("Global error:",e.error),this.logError(e.error)}),window.addEventListener("unhandledrejection",e=>{console.error("Unhandled promise rejection:",e.reason),this.logError(e.reason)}),document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&"r"===e.key&&e.shiftKey&&(e.preventDefault(),this.refreshAllTools()),"Escape"===e.key&&this.closeAllModals()}),"serviceWorker"in navigator&&this.registerServiceWorker()}async registerServiceWorker(){}refreshAllTools(){qrngService.clearCache(),this.showNotification("üîÑ All tools refreshed","success")}closeAllModals(){document.querySelectorAll(".dropdown.open").forEach(e=>{e.classList.remove("open")})}showGlobalError(e){const t=document.createElement("div");t.className="global-error",Object.assign(t.style,{position:"fixed",top:"0",left:"0",width:"100%",zIndex:"9999",backgroundColor:"#FEF2F2",color:"#991B1B",borderBottom:"1px solid #FCA5A5",padding:"1rem",textAlign:"center",boxShadow:"0 4px 6px -1px androidx.core.graphics.drawable.IconCompatParcelizer"}),t.innerHTML=`\n      <div class="error-content" style="display: flex; justify-content: center; items-align: center; gap: 0.5rem; max-width: 1200px; margin: 0 auto;">\n        <span class="error-message">${e}</span>\n        <button class="error-close" style="background: none; border: none; font-size: 1.25rem; cursor: pointer; color: #991B1B;">&times;</button>\n      </div>\n    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1e4),t.querySelector(".error-close").addEventListener("click",()=>{t.parentNode&&t.parentNode.removeChild(t)})}showNotification(e,t="info"){const o=document.createElement("div");o.className=`notification ${t}`,o.textContent=e,document.body.appendChild(o),setTimeout(()=>o.classList.add("show"),100),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},300)},3e3)}logError(e){try{const t=JSON.parse(localStorage.getItem("quantumLabErrors")||"[]");t.push({timestamp:(new Date).toISOString(),message:e.message||String(e),stack:e.stack,userAgent:navigator.userAgent,url:window.location.href}),t.length>10&&t.splice(0,t.length-10),localStorage.setItem("quantumLabErrors",JSON.stringify(t))}catch(e){console.warn("Failed to log error:",e)}}getTool(e){return this.tools[e]}getUsageStatistics(){try{return{stats:JSON.parse(localStorage.getItem("quantumLabStats")||"{}"),counters:JSON.parse(localStorage.getItem("quantumLabCounters")||"{}"),errors:JSON.parse(localStorage.getItem("quantumLabErrors")||"[]")}}catch(e){return{stats:{},counters:{},errors:[]}}}clearAllData(){confirm("Clear all app data including usage statistics and cached values?")&&(localStorage.removeItem("quantumLabStats"),localStorage.removeItem("quantumLabCounters"),localStorage.removeItem("quantumLabErrors"),localStorage.removeItem("quantumCoinHistory"),qrngService.clearCache(),this.showNotification("‚úÖ All data cleared","success"))}}let app;window.showPrivacyInfo=()=>{alert("üîí Privacy Policy\n\nQuantum Random Lab respects your privacy:\n\n‚Ä¢ All random number generation happens locally in your browser\n‚Ä¢ We do not store, transmit, or log any generated content (passwords, names, etc.)\n‚Ä¢ Usage statistics are stored locally on your device only\n‚Ä¢ No personal data is collected or transmitted to external servers\n‚Ä¢ The ANU QRNG API receives only requests for random data, no personal information\n\nYour generated content never leaves your device unless you explicitly copy or download it.")},window.showApiInfo=async()=>{try{const e=await qrngService.getHealth(),t=qrngService.getCacheStatus(),o=app.getUsageStatistics(),n=`üìä API Status Information\n\nService Status: ${e.status}\nAPI Key Configured: ${e.apiKeyConfigured?"Yes":"No"}\nLast Check: ${new Date(e.timestamp).toLocaleString()}\n\nCache Status:\n${t.map(e=>`${e.type}: ${e.count}/${e.capacity} (${e.percentage}%)`).join("\n")}\n\nUsage Statistics:\nAPI Requests: ${o.counters.api_requests||0}\nCache Hits: ${o.counters.cache_hits||0}\nCache Misses: ${o.counters.cache_misses||0}\nErrors: ${o.counters.api_errors||0}`;alert(n)}catch(e){alert("Failed to fetch API status information.")}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{app=new QuantumRandomApp}):app=new QuantumRandomApp,window.app=app;